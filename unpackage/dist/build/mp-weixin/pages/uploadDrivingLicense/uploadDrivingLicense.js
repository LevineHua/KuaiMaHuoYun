(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/uploadDrivingLicense/uploadDrivingLicense"],{"1b10":function(e,a,n){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n={data:function(){return{userinfo:"",cardBack:"",cardDue:"",holdCard:"",driving:"",carDriving:"",cardName:"",driverLicenseId:"",drivingLicense:"",carNumber:"",card_up:"",card_down:"",card_left:"",carInfo:"",examine:"",cardIsTrue:100,type:0}},onLoad:function(a){var n=this;this.userinfo=e.getStorageSync("userinfo"),console.log(this.userinfo),this.examine=e.getStorageSync("examine"),this.type=a.type,1==this.type&&(e.setNavigationBarTitle({title:"修改驾驶证"}),e.request({url:n.serverURL+"/home/user/get_car_examine",method:"POST",data:{user_id:n.userinfo.user_id},success:function(e){console.log(e),100==e.data.code&&(n.cardDue=n.href+e.data.msg.card_up,n.cardBack=n.href+e.data.msg.card_down,n.holdCard=n.href+e.data.msg.card_left,n.carDriving=n.href+e.data.msg.driving_up,n.cardName=e.data.msg.nickname,n.driverLicenseId=e.data.msg.drive_num,n.drivingLicense=e.data.msg.travel_num,n.carNumber=e.data.msg.car_num,n.carInfo=e.data.msg.car_type,n.card_up=e.data.msg.card_up,n.card_down=e.data.msg.card_down,n.card_left=e.data.msg.card_left,n.driving=e.data.msg.driving_up)},fail:function(e){console.log(e)}}))},onShow:function(){var a=this;if(1!=this.type){var n=e.getStorageSync("current"),o=e.getStorageSync("currentCT"),t=e.getStorageSync("currentCL");a.carInfo=""!=n?n:""!=o&&""!=t?o+"/"+t:""}},methods:{nextStep:function(){var a=this;if(""==a.card_up)e.showToast({title:"驾驶证正面照片不能为空",icon:"none",mask:!0});else if(""==a.card_down)e.showToast({title:"驾驶证反面照片不能为空",icon:"none",mask:!0});else if(""==a.card_left)e.showToast({title:"车牌照片不能为空",icon:"none",mask:!0});else if(""==a.card_left)e.showToast({title:"行驶证照片不能为空",icon:"none",mask:!0});else if(""==a.cardName)e.showToast({title:"姓名不能为空",icon:"none",mask:!0});else if(""==a.driverLicenseId)e.showToast({title:"驾驶证号不能为空",icon:"none",mask:!0});else if(""==a.driving)e.showToast({title:"行驶证号不能为空",icon:"none",mask:!0});else if(""==a.carNumber)e.showToast({title:"车牌号不能为空",icon:"none",mask:!0});else if(""==a.carInfo)e.showToast({title:"请选择车辆信息",icon:"none",mask:!0});else if(100!=a.cardIsTrue)e.showToast({title:"驾驶证有误",icon:"none",mask:!0});else{var n=a.serverURL;e.showModal({title:"",content:"我已确认并保证信息准确！",success:function(o){o.confirm&&e.request({url:n+"home/user/car_examine",method:"POST",data:{user_id:a.userinfo.user_id,card_up:a.card_up,card_down:a.card_down,card_left:a.card_left,nickname:a.cardName,drive_num:a.driverLicenseId,travel_num:a.drivingLicense,driving_up:a.driving,car_num:a.carNumber,car_type:a.carInfo},success:function(n){console.log(n),100==n.data.code&&(1==a.type?(e.setStorageSync("examine",7),e.showToast({title:"上传成功",icon:"success",mask:!0,success:function(){setTimeout(function(){e.navigateBack()},1500)}})):(e.setStorageSync("examine",6),e.showToast({title:"上传成功",icon:"success",mask:!0,success:function(){setTimeout(function(){e.switchTab({url:"../index/index"})},1500)}})),e.removeStorageSync("current"),e.removeStorageSync("currentCT"),e.removeStorageSync("currentCL"))}})}})}},selectCar:function(){e.navigateTo({url:"../selectCar/selectCar"})},selectCardImg:function(a){var n=this,o=n.serverURL;e.chooseImage({count:1,sourceType:["camera"],success:function(t){var c=t.tempFilePaths[0];"back"==a?n.cardBack=c:"due"==a&&(n.cardDue=c),console.log(c),console.log("选择图片成功"),e.showLoading({title:"上传中..."}),e.uploadFile({url:o+"index/index/uploadImage",filePath:c,name:"filePath",formData:{uid:n.userinfo.user_id},success:function(t){if(e.hideLoading(),200==t.statusCode){var r=JSON.parse(t.data);100==r.code&&("back"==a?(n.cardBack=c,n.card_down=r.url):"due"==a?(n.cardDue=c,n.card_up=r.url,e.request({url:o+"index/index/code_drivingLicense",method:"POST",data:{image:r.url},success:function(a){console.log(a),e.hideLoading(),n.cardIsTrue=a.data.code,100==a.data.code?(n.cardName=a.data.date.words_result.姓名.words,n.driverLicenseId=a.data.date.words_result.证号.words):e.showModal({content:a.data.msg,confirmText:"确定",showCancel:!1})},fail:function(e){console.log(e)}})):"driving"==a&&(n.carDriving=c,n.driving=r.url,e.request({url:o+"index/index/code_vehicleLicense",method:"POST",data:{image:r.url},success:function(a){console.log(a),e.hideLoading(),n.cardIsTrue=a.data.code,100==a.data.code?0!=a.data.date.words_result_num?(n.drivingLicense=a.data.date.words_result.号牌号码.words,n.carNumber=a.data.date.words_result.车辆识别代号.words):e.showModal({content:"上传的行驶证有误",confirmText:"确定",showCancel:!1}):e.showModal({content:a.data.msg,confirmText:"确定",showCancel:!1})},fail:function(e){console.log(e)}})),console.log("上传图片成功"))}},fail:function(){console.log("上传失败")},complete:function(){console.log("上传结束")}})},fail:function(){console.log("选择图片失败")},complete:function(){console.log("选择图片完成")}})},carImg:function(){var a=this,n=a.serverURL;e.chooseImage({count:1,success:function(o){var t=o.tempFilePaths[0];a.holdCard=t,console.log(t),e.showLoading({title:"上传中..."}),e.uploadFile({url:n+"index/index/uploadImage",filePath:t,name:"filePath",formData:{uid:a.userinfo.user_id},success:function(n){if(e.hideLoading(),200==n.statusCode){var o=JSON.parse(n.data);100==o.code&&(a.holdCard=t,a.card_left=o.url)}},fail:function(){console.log("上传失败")},complete:function(){console.log("上传结束")}})},fail:function(){console.log("选择图片失败")},complete:function(){console.log("选择图片完成")}})}}};a.default=n}).call(this,n("543d")["default"])},7559:function(e,a,n){"use strict";var o=function(){var e=this,a=e.$createElement;e._self._c},t=[];n.d(a,"a",function(){return o}),n.d(a,"b",function(){return t})},"7ea5":function(e,a,n){"use strict";var o=n("96d1"),t=n.n(o);t.a},"96d1":function(e,a,n){},c129:function(e,a,n){"use strict";n.r(a);var o=n("1b10"),t=n.n(o);for(var c in o)"default"!==c&&function(e){n.d(a,e,function(){return o[e]})}(c);a["default"]=t.a},c874:function(e,a,n){"use strict";n.r(a);var o=n("7559"),t=n("c129");for(var c in t)"default"!==c&&function(e){n.d(a,e,function(){return t[e]})}(c);n("7ea5");var r=n("2877"),i=Object(r["a"])(t["default"],o["a"],o["b"],!1,null,null,null);a["default"]=i.exports}},[["29a6","common/runtime","common/vendor"]]]);